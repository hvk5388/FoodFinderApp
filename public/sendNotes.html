<html>
   <head>
      <title>Send Notes</title>
      <link href="stylesheets/notesStyles.css" rel="stylesheet">
      <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600&display=swap" rel="stylesheet">
      <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
      <link rel="icon" href="images/knife_fork.png" type="image/png" sizes="32x32">
      <script type="text/javascript" src="scripts/notes.js"></script>
      <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
      <script>
         function changeFilter(icon) {
            if(icon.src = "images/star.png") { //shows use of if else statements
               icon.scr = "images/star1.png"; //demonstrates dom manipulations
            } else if(icon.src = "images/star1.png"){
               icon.src = "images/star.png";
            }
         }

         function changeDollar(icon) {
            if(icon.src = "images/dollar.png") {
               icon.scr = "images/dollar1.png";
            } else if(icon.src = "images/dollar1.png"){
               icon.src = "images/dollar.png";
            }
         }

         var form_id_js = "email_form";

         var data_js = { //demonstrates use of objects
            "access_token": "9vtj4szaxzb00w5vzgsycvsy"
         };

         function js_onSuccess() {
            // remove this to avoid redirect
            window.location = window.location.pathname + "?message=Email+Successfully+Sent%21&isError=0";
         }

         function js_onError(error) {
            // remove this to avoid redirect
            window.location = window.location.pathname + "?message=Email+could+not+be+sent.&isError=1";
         }

         var sendButton = $("#" + form_id_js + " [name='send']"); //demonstrates use of jquery

         function js_send() {
            sendButton.value='Sendingâ€¦';
            sendButton.disabled=true;
            var request = new XMLHttpRequest();
            request.onreadystatechange = function() {
                  if (request.readyState == 4 && request.status == 200) { //demonstrates use of conditionals
                     js_onSuccess();
                  } else
                  if(request.readyState == 4) {
                     js_onError(request.response);
                  }
            };

            var subject = document.querySelector("#" + form_id_js + " [name='subject']").value;
            var message = document.querySelector("#" + form_id_js + " [name='text']").value;
            data_js['subject'] = subject;
            data_js['text'] = message;
            var params = toParams(data_js);

            request.open("POST", "https://postmail.invotes.com/send", true);
            request.setRequestHeader("Content-type", "application/x-www-form-urlencoded");

            request.send(params);

            return false;
         }

         sendButton.onclick = js_send;

         function toParams(data_js) { //demonstrates use of functions
            var form_data = []; //demonstrates use of arrays
            for ( var key in data_js ) { //demonstrates use of loops
                  form_data.push(encodeURIComponent(key) + "=" + encodeURIComponent(data_js[key]));
            }

            return form_data.join("&");
         }

         var js_form = document.getElementById(form_id_js);
         js_form.addEventListener("submit", function (e) {
            e.preventDefault();
         });

         var submitButton = document.getElementById("submit_form");
         var form = document.getElementById("email_form");
         form.addEventListener("submit", function (e) {
            setTimeout(function() {
                  submitButton.value = "Sending...";
                  submitButton.disabled = true;
            }, 1);
         });

         //recieved help from https://postmail.invotes.com
      </script>
   </head>
   <header>
      <h1 id="headerTitle">Notes</h1>
      <div id="menuBtn">
         <span id="menuIcon" class="material-icons">menu</span>
         <div class="dropdown-content">
            <a href="index.html">Home</a>
            <hr>
            <a href="restaurants.html">Restaurants</a>
            <hr>
            <a href="favorites.html">Favorites</a>
            <hr>
            <a href="myNotes.html">Notes</a>
         </div>
      </div>
   </header>
   <body>
      <a href="myNotes.html" id="xButton"><span id="clearIcon" class="material-icons">clear</span></a>
      <!--Shows use of table-->
      <table id="popup">
         <tr>
            <th colspan="3">Send Notes</th>
         </tr>
         <tr>
            <td id="category">Food: </td>
            <td>
               <img src="images/star1.png" alt="star" id="stars61" onclick="changeFilter(document.getElementById('stars61'))">
               <img src="images/star1.png" alt="star" id="stars62" onclick="changeFilter(document.getElementById('stars62'))">
               <img src="images/star1.png" alt="star" id="stars63" onclick="changeFilter(document.getElementById('stars63'))">
               <img src="images/star1.png" alt="star" id="stars64" onclick="changeFilter(document.getElementById('stars64'))">
               <img src="images/star1.png" alt="star" id="stars65" onclick="changeFilter(document.getElementById('stars65'))">
            </td>
         </tr>
         <tr>
            <td id="category">Service: </td>
            <td>
               <img src="images/star1.png" alt="star" id="stars71" onclick="changeFilter(document.getElementById('stars71'))">
               <img src="images/star1.png" alt="star" id="stars72" onclick="changeFilter(document.getElementById('stars72'))">
               <img src="images/star1.png" alt="star" id="stars73" onclick="changeFilter(document.getElementById('stars73'))">
               <img src="images/star1.png" alt="star" id="stars74" onclick="changeFilter(document.getElementById('stars74'))">
               <img src="images/star1.png" alt="star" id="stars75" onclick="changeFilter(document.getElementById('stars75'))">
            </td>
         </tr>
         <tr>
            <td id="category">Price: </td>
            <td>
               <img src="images/dollar1.png" alt="dollar" id="dollar41" onclick="changeDollar(document.getElementById('dollar41'))">
               <img src="images/dollar1.png" alt="dollar" id="dollar42" onclick="changeDollar(document.getElementById('dollar42'))">
               <img src="images/dollar1.png" alt="dollar" id="dollar43" onclick="changeDollar(document.getElementById('dollar43'))">
               <img src="images/dollar1.png" alt="dollar" id="dollar44" onclick="changeDollar(document.getElementById('dollar44'))">
               <img src="images/dollar1.png" alt="dollar" id="dollar45" onclick="changeDollar(document.getElementById('dollar45'))">
            </td>
         </tr>
         <tr>
            <!--Shows use of special character-->
            <td>&nbsp;</td>
         </tr>
         <tr>
            <td></td>
            <td>
               <div class="checkbox-container">
                  <form id="optionForm"></form>
                  </label><b>Send to Reviewer to be Posted:</b></label> 
                  <br>I will forward you the email when recieved
                  <br>Please return to this page once message is sent
                  <hr>
                  </form>
                  <form action="https://postmail.invotes.com/send" method="post" id="email_form">
                  Name:<br>
                  <input type="text" name="name" placeholder="Name"><br>
                  Subject:<br>
                  <input type="text" name="subject" placeholder="Subject"><br>
                  Message:<br>
                  <textarea name="text" placeholder="Message"></textarea><br>
                  <br>
                  <input type="submit" value="Send" id="js_send" name="send">
                  <input type="hidden" name="access_token" value="9vtj4szaxzb00w5vzgsycvsy" />
                  <input type="hidden" name="success_url" value=".?message=Email+Successfully+Sent%21&isError=0" />
                  <input type="hidden" name="error_url" value=".?message=Email+could+not+be+sent.&isError=1" />
                  </form>
               </div>
            </td>
            <td width="60px">&nbsp;</td>
         </tr>
      </table>
   </body>
</html>